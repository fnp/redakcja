{% extends "base.html" %}

{% block extrahead %}
    <script src="/static/js/jquery.fieldselection.js" type="text/javascript" charset="utf-8"></script>
    <script src="/static/js/jquery.lazyload.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">        
        function addEditorButton(label, fn) {
            $('<button type="button">' + label + '</button>').click(function(event) {
                var text = $('#id_text').getSelection().text;
                $('#id_text').replaceSelection(fn(text));
                event.preventDefault();
            }).appendTo('#buttons');
        }
        
        $(function() {
            $('#id_folders').change(function() {
                $('#images').load('/images/' + $('#id_folders').val() + '/', function() {
                    $('#images').data('lastScroll', -1000);
                });
            });

            addEditorButton('utwór', function(text) { return '<utwor>' + text + '</utwor>'; });
            addEditorButton('akap', function(text) { return '<akap>' + text + '</akap>'; });
            
            $('#images').lazyload('.image-box', {threshold: 600});
        });
    </script>
{% endblock extrahead %}

{% block breadcrumbs %}<a href="/">Platforma Redakcyjna</a> ❯ plik {{ hash }}{% endblock breadcrumbs %}

{% block maincontent %}
    <div id="tabs"><a href="{% url file_xml hash %}" class="active">Źródło</a><a href="{% url file_html hash %}">HTML</a>    <div style="padding: 3px; margin-left: 10px">{{ image_folders_form.folders }}</div><div style="clear: both; height: 0; width: 0">&nbsp;</div></div>    

    <div id="images">
        <p>Aby zobaczyć obrazki wybierz folder z obrazkami powyżej.</p>
    </div>
    <form action="." method="post" accept-charset="utf-8">
        <div id="buttons"></div>
        {{ form.text }}
        {{ form.user.errors }}
        <p>Użytkownik: {{ form.user }}</p> 
        {{ form.commit_message.errors }}
        <p>Opis zmian: {{ form.commit_message }} <input type="submit" value="Zapisz"/></p>
    </form>
{% endblock maincontent %}    
