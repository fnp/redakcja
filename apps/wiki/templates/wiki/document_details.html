{% extends "base.html" %}
{% load toolbar_tags %}
{% block title %}{{ document.name }} - {{ block.super }}{% endblock %}
{% block extrahead %}
{% load compressed %}
{% compressed_css 'detail' %}
{% endblock %}

{% block extrabody %}
<script type="text/javascript" charset="utf-8">
    var STATIC_URL = '{{STATIC_URL}}';
</script>
<script src="{{STATIC_URL}}js/lib/codemirror/codemirror.js" type="text/javascript" charset="utf-8">
</script>
{% compressed_js 'detail' %}
{% endblock %}
{% block maincontent %}
<div id="loading-overlay">
    <div id="loading-message">
        <img src="{{STATIC_URL}}img/spinner.gif" />
        <p>
            Ładowanie
        </p>
    </div>
</div>

<div id="document-meta"
	data-document-name="{{ document.name }}" style="display:none">

	{% for k, v in document_meta.items %}
		<span data-key="{{ k }}">{{ v }}</span>
	{% endfor %}
</div>

<div id="header">
    <h1><a href="{% url wiki.views.document_list %}">Platforma</a></h1>
    <div id="tools">
        <a href="{{ REDMINE_URL }}projects/wl-publikacje/wiki/Pomoc" target="_blank">Pomoc</a>
        | {% include "registration/head_login.html" %}
        | Wersja: <span id="document-revision">unknown</span>
        |
        <button style="margin-left: 6px" id="save-button">
            Zapisz
        </button>
    </div>
    <ol id="tabs">
		<li id="SummaryPerspective"
			data-ui-related="summary-view-editor"
			data-ui-jsclass="SummaryPerspective">
            <span>{{ document_meta.title }}</span>
        </li>

        <li id="VisualPerspective"
			data-ui-related="simple-editor"
			data-ui-jsclass="VisualPerspective">
            <span>Edytor</span>
        </li>

		<li id="HistoryPerspective"
			data-ui-related="history-view-editor"
			data-ui-jsclass="HistoryPerspective">
            <span>Historia</span>
        </li>

		<li id="CodeMirrorPerspective"
			data-ui-related="source-editor"
			data-ui-jsclass="CodeMirrorPerspective">
            <span>Kod źródłowy</span>
        </li>
    </ol>
</div>
<div id="splitter">
    <div id="editor">
        <div id="source-editor" class="editor">
            {% toolbar %}
            <textarea id="codemirror_placeholder">&lt;br/&gt;</textarea>
            <input type="hidden" name="name" value="{{ document.name }}" /><input type="hidden" name="author" value="annonymous" /><input type="hidden" name="comment" value="no comment" /><input type="hidden" name="revision" value="{{ document_info.revision }}" />
        </div>
        <div id="simple-editor" class="editor" style="display: none">
            <div id="html-view" class="htmlview">
            </div>
            <div class="toolbar">
                <button id="insert-theme-button">
                    Wstaw motyw
                </button>
                <button id="insert-annotation-button">
                    Wstaw przypis
                </button>
                <div class="toolbar-end">
                </div>
            </div>
        </div>
		{% include "wiki/history_view.html" %}
		{% include "wiki/summary_view.html" %}
    </div>
    <div class="vsplitbar" title="Klinknij aby (ro)zwinąć galerię."> </div>

	<div id="side-gallery">
		<!-- gallery toolbar -->
        <div class="toolbar">
            <button class="previous-page">
                <img src="{{STATIC_URL}}icons/go-previous.png" alt="Poprzednia" title="Poprzednia"/>
            </button><input type="text" size="3" maxlength="3" value="1" class="page-number" />
            <button class="next-page">
                <img src="{{STATIC_URL}}icons/go-next.png" alt="Następna" title="Następna"/>
            </button>
            <button class="zoom-in">
                Powiększ
            </button>
            <button class="zoom-out">
                Pomniejsz
            </button>
            <div class="toolbar-end">
            </div>
        </div>
		<div class="error_message"> </div>
		<div class="gallery-image">
			<img src="{{MEDIA_URL}}/images/empty.png" />
		</div>
    </div>
</div>
{% include "wiki/save_dialog.html" %}
{% include "wiki/tag_dialog.html" %}
{% endblock %}